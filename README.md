# Terrain Generator ğŸ—ºï¸

Terrain Generator æ˜¯ä¸€ä¸ªä½¿ç”¨ Perlin å™ªå£°ç®—æ³•ç”Ÿæˆéšæœºåœ°å½¢çš„ C++ æ§åˆ¶å°å·¥å…·ã€‚è¿™æ˜¯ä¸€ä¸ª**ä¸ªäººå­¦ä¹ é¡¹ç›®**ï¼Œç”¨äºå­¦ä¹ å’Œå®è·µä»¥ä¸‹å†…å®¹ï¼š
- Perlin å™ªå£°ç®—æ³•çš„å®ç°
- C++ é¢å‘å¯¹è±¡ç¼–ç¨‹
- æ§åˆ¶å°å½©è‰²è¾“å‡º
- æ¨¡å—åŒ–ä»£ç ç»„ç»‡
- ç‰ˆæœ¬æ§åˆ¶ä¸ GitHub é¡¹ç›®è§„èŒƒ

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œå¯ä»¥äº†è§£ç¨‹åºåŒ–å†…å®¹ç”Ÿæˆï¼ˆPCGï¼‰çš„åŸºç¡€åŸç†ï¼Œä»¥åŠå¦‚ä½•å°†å™ªå£°ç®—æ³•åº”ç”¨äºåœ°å½¢ç”Ÿæˆã€‚

## ä¸»è¦åŠŸèƒ½

ğŸ’¯ **å®Œå…¨å¼€æº
âœ¨ **Perlin å™ªå£°ç®—æ³•
ğŸŒ **10 ç§ç”Ÿç‰©ç¾¤ç³»
ğŸ¨ **å½©è‰²ç»ˆç«¯è¾“å‡º
âš™ï¸ **å¯é…ç½®å‚æ•°
ğŸ“Š **ç»Ÿè®¡ä¿¡æ¯å±•ç¤º
ğŸ”„ **åœ°å½¢é‡æ–°ç”Ÿæˆ
ğŸ­ **ä¸¤ç§æ˜¾ç¤ºæ¨¡å¼

## ç”Ÿç‰©ç¾¤ç³»

| é«˜åº¦èŒƒå›´ | åœ°å½¢ç±»å‹ | é¢œè‰² |
|---------|---------|------|
| 0.00 - 0.30 | æ·±æµ· | æ·±è“è‰² |
| 0.30 - 0.35 | æµ…æµ· | æµ…è“è‰² |
| 0.35 - 0.40 | æ²™æ»© | é»„è‰² |
| 0.40 - 0.50 | ä½è‰åœ° | æ·±ç»¿è‰² |
| 0.50 - 0.60 | ä¸­è‰åœ° | ä¸­ç»¿è‰² |
| 0.60 - 0.70 | é«˜è‰åœ° | æµ…ç»¿è‰² |
| 0.70 - 0.80 | ä½å±± | æ£•è‰² |
| 0.80 - 0.90 | ä¸­å±± | æµ…æ£•è‰² |
| 0.90 - 0.95 | é«˜å±± | ç°è‰² |
| 0.95 - 1.00 | é›ªå±± | ç™½è‰² |

## å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨ Visual Studio æ„å»º

1. å…‹éš†ä»“åº“
```bash
git clone https://github.com/your-username/Terrain_Generator.git
cd Terrain_Generator
```

2. é€‰æ‹©æ„å»ºé…ç½® (Debug æˆ– Release) å’Œå¹³å° (x64)

3. æ„å»ºè§£å†³æ–¹æ¡ˆ (Ctrl+Shift+B)

4. è¿è¡Œåº”ç”¨ç¨‹åº

## ç³»ç»Ÿè¦æ±‚

- C++20 å…¼å®¹ç¼–è¯‘å™¨
- Windows æ“ä½œç³»ç»Ÿ
- Visual Studio 2022 (v145 å·¥å…·é›†) æˆ–æ›´æ–°ç‰ˆæœ¬
- æ”¯æŒ ANSI é¢œè‰²çš„ç»ˆç«¯ (Windows Terminalã€VS Code ç»ˆç«¯ç­‰)

## ğŸ“‚ æ¼”ç¤ºç¨‹åº (Demos)

é¡¹ç›®åŒ…å« 7 ä¸ªæ¼”ç¤ºç¨‹åºï¼Œå±•ç¤ºä¸åŒçš„åœ°å½¢ç”Ÿæˆæ•ˆæœå’Œå‚æ•°é…ç½®ã€‚æŸ¥çœ‹ `demos/` ç›®å½•è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

| Demo | åç§° | å‚æ•°é…ç½® | æ•ˆæœè¯´æ˜ |
|-----|------|---------|---------|
| **Demo 01** | åŸºæœ¬åœ°å½¢ç”Ÿæˆ | scale=0.03, octaves=5, persistence=0.5 | é»˜è®¤å‚æ•°çš„å¹³è¡¡åœ°å½¢ |
| **Demo 02** | å¹³æ»‘å¹³åŸ | scale=0.02, octaves=3, persistence=0.4 | å¹³ç¼“çš„å¹³åŸåœ°å½¢ |
| **Demo 03** | å´å²–å±±åœ° | scale=0.025, octaves=8, persistence=0.8 | å°–é”çš„å±±åœ°åœ°å½¢ |
| **Demo 04** | å¤§å‹åœ°å½¢ç‰¹å¾ | scale=0.01, octaves=5, persistence=0.5 | å¤§å‹å¤§é™†å’Œæµ·æ´‹ |
| **Demo 05** | å°å‹ç»†èŠ‚åœ°å½¢ | scale=0.08, octaves=6, persistence=0.6 | ç²¾ç»†çš„å°å°ºåº¦ç»†èŠ‚ |
| **Demo 06** | å¯å˜å¯†åº¦æ˜¾ç¤º | scale=0.03, octaves=5, persistence=0.55 | ä¸åŒå¯†åº¦æ–¹å—å±•ç¤º |
| **Demo 07** | å¤šåœ°å½¢å¯¹æ¯” | å¤šç§é…ç½® | åŒæ—¶å±•ç¤ºä¸‰ç§åœ°å½¢æ•ˆæœ |

### ä½¿ç”¨ Demo

1. æµè§ˆ `demos/` ç›®å½•ï¼Œé€‰æ‹©æƒ³è¦è¿è¡Œçš„ demo
2. å°†è¯¥ demo çš„å†…å®¹å¤åˆ¶åˆ° `src/main.cpp`
3. åœ¨ Visual Studio ä¸­ç¼–è¯‘å¹¶è¿è¡Œ

æˆ–è€…æŸ¥çœ‹ `demos/README.md` è·å–æ›´è¯¦ç»†çš„è¯´æ˜å’Œå‚æ•°è°ƒä¼˜æŠ€å·§ã€‚

## æ–‡ä»¶ç›®å½•è¯´æ˜

```
Terrain_Generator/
â”œâ”€â”€ Terrain_Generator/
â”‚   â”œâ”€â”€ include/                          # å¤´æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ perlin_noise.hpp           # Perlin å™ªå£°ç®—æ³•å¤´æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ terrain_generator.hpp      # åœ°å½¢ç”Ÿæˆå™¨ç±»å¤´æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ color_utils.hpp           # é¢œè‰²å·¥å…·å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ src/                            # æºæ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ perlin_noise.cpp          # Perlin å™ªå£°ç®—æ³•å®ç°
â”‚   â”‚   â”œâ”€â”€ terrain_generator.cpp     # åœ°å½¢ç”Ÿæˆå™¨ç±»å®ç°
â”‚   â”‚   â”œâ”€â”€ color_utils.cpp          # é¢œè‰²å·¥å…·å®ç°
â”‚   â”‚   â””â”€â”€ main.cpp                 # åº”ç”¨ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ demos/                          # æ¼”ç¤ºç¨‹åºç›®å½•
â”‚   â”‚   â”œâ”€â”€ README.md                 # Demo ä½¿ç”¨è¯´æ˜
â”‚   â”‚   â”œâ”€â”€ demo01_basic.cpp          # åŸºæœ¬åœ°å½¢ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ demo02_smooth_plains.cpp  # å¹³æ»‘å¹³åŸ
â”‚   â”‚   â”œâ”€â”€ demo03_rugged_mountains.cpp # å´å²–å±±åœ°
â”‚   â”‚   â”œâ”€â”€ demo04_large_scale.cpp    # å¤§å‹åœ°å½¢ç‰¹å¾
â”‚   â”‚   â”œâ”€â”€ demo05_small_scale.cpp    # å°å‹ç»†èŠ‚åœ°å½¢
â”‚   â”‚   â”œâ”€â”€ demo06_variable_density.cpp # å¯å˜å¯†åº¦æ˜¾ç¤º
â”‚   â”‚   â””â”€â”€ demo07_comparison.cpp    # å¤šåœ°å½¢å¯¹æ¯”
â”‚   â””â”€â”€ Terrain_Generator.vcxproj      # Visual Studio é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ .gitignore                         # Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ LICENSE                            # MIT è®¸å¯è¯æ–‡ä»¶
â””â”€â”€ README.md                          # æœ¬è¯´æ˜æ–‡æ¡£
```

### å„æ–‡ä»¶åŠŸèƒ½è¯¦è§£

#### å¤´æ–‡ä»¶ (`include/`)

| æ–‡ä»¶å | åŠŸèƒ½æè¿° |
|-------|---------|
| **perlin_noise.hpp** | å®šä¹‰ PerlinNoise ç±»ï¼ŒåŒ…å«å™ªå£°ç”Ÿæˆçš„æ ¸å¿ƒæ¥å£ã€‚å£°æ˜äº†æ„é€ å‡½æ•°ã€å™ªå£°ç”Ÿæˆã€å…«åº¦å™ªå£°ç­‰å…¬å…±æ–¹æ³•ï¼Œä»¥åŠæ·¡å…¥æ·¡å‡ºã€çº¿æ€§æ’å€¼ã€æ¢¯åº¦è®¡ç®—ç­‰ç§æœ‰è¾…åŠ©æ–¹æ³•ã€‚ |
| **terrain_generator.hpp** | å®šä¹‰ TerrainConfig ç»“æ„ä½“å’Œ TerrainGenerator ç±»ã€‚TerrainConfig å­˜å‚¨åœ°å½¢ç”Ÿæˆçš„é…ç½®å‚æ•°ï¼›TerrainGenerator è´Ÿè´£ç”Ÿæˆã€å½’ä¸€åŒ–ã€æ˜¾ç¤ºåœ°å½¢ï¼Œæä¾›å„ç§æ˜¾ç¤ºæ¨¡å¼ã€‚ |
| **color_utils.hpp** | å®šä¹‰é¢œè‰²ç›¸å…³çš„å¸¸é‡å’Œå·¥å…·å‡½æ•°ï¼ŒåŒ…å«å„ç§ç”Ÿç‰©ç¾¤ç³»é¢œè‰²å’Œé«˜åº¦æ˜ å°„å‡½æ•°ã€‚ |

#### æºæ–‡ä»¶ (`src/`)

| æ–‡ä»¶å | åŠŸèƒ½æè¿° |
|-------|---------|
| **perlin_noise.cpp** | å®ç° PerlinNoise ç±»çš„å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–ç½®æ¢è¡¨ã€å™ªå£°è®¡ç®—ã€å…«åº¦å™ªå£°å åŠ ç­‰æ ¸å¿ƒé€»è¾‘ã€‚ |
| **terrain_generator.cpp** | å®ç° TerrainGenerator ç±»çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬åœ°å½¢ç”Ÿæˆã€å½’ä¸€åŒ–ã€ä¸åŒæ˜¾ç¤ºæ¨¡å¼ã€å›¾ä¾‹å’Œç»Ÿè®¡ä¿¡æ¯è¾“å‡ºã€‚ |
| **color_utils.cpp** | å®ç°é¢œè‰²å·¥å…·å‡½æ•°ï¼Œæ ¹æ®é«˜åº¦å€¼è¿”å›å¯¹åº”çš„ç”Ÿç‰©ç¾¤ç³»é¢œè‰²ã€‚ |
| **main.cpp** | ç¨‹åºå…¥å£ç‚¹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ TerrainGenerator ç”Ÿæˆä¸åŒç±»å‹çš„åœ°å½¢ã€‚ |

## æ ¸å¿ƒç®—æ³•è§£æ

### Perlin å™ªå£°ç®—æ³•

Perlin å™ªå£°æ˜¯ Ken Perlin åœ¨ 1985 å¹´å‘æ˜çš„æ¢¯åº¦å™ªå£°ç®—æ³•ï¼Œç”¨äºç”Ÿæˆè‡ªç„¶ã€è¿ç»­çš„ä¼ªéšæœºå™ªå£°ã€‚æœ¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯ 2D Perlin å™ªå£°ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

#### 1. ç½®æ¢è¡¨åˆå§‹åŒ–

```cpp
permutation = {
    // 256 ä¸ªéšæœºæ’åˆ—çš„æ•´æ•°
};
permutation.insert(permutation.end(), permutation.begin(), permutation.end());
```

- ä½¿ç”¨ä¸€ä¸ªå›ºå®šçš„ 256 å…ƒç´ çš„ç½®æ¢è¡¨ï¼ˆpermutation tableï¼‰
- å°†å…¶å¤åˆ¶ä¸€ä»½æ‹¼æ¥åˆ°æœ«å°¾ï¼Œé¿å…è¾¹ç•Œæ£€æŸ¥
- æ¯ä¸ªåæ ‡ä¼šæ˜ å°„åˆ°è¿™ä¸ªè¡¨ä¸­çš„ä¼ªéšæœºå€¼

#### 2. ç½‘æ ¼å•å…ƒå®šä½

```cpp
int X = (int)floor(x) & 255;
int Y = (int)floor(y) & 255;
```

- å°†è¾“å…¥åæ ‡ `(x, y)` åˆ’åˆ†ä¸ºç½‘æ ¼å•å…ƒ
- æ‰¾åˆ°åŒ…å«è¯¥ç‚¹çš„ç½‘æ ¼å•å…ƒå››ä¸ªè§’çš„åæ ‡

#### 3. å±€éƒ¨åæ ‡è®¡ç®—

```cpp
x -= floor(x);  // 0 <= x < 1
y -= floor(y);  // 0 <= y < 1
```

- è®¡ç®—ç‚¹åœ¨ç½‘æ ¼å•å…ƒå†…çš„ç›¸å¯¹åæ ‡
- å°†åæ ‡å½’ä¸€åŒ–åˆ° [0, 1) åŒºé—´

#### 4. æ·¡å…¥æ·¡å‡ºå‡½æ•°ï¼ˆFade Functionï¼‰

```cpp
double fade(double t) {
    return t * t * t * (t * (t * 6 - 15) + 10);
}
```

- è¿™æ˜¯ä¸€ä¸ª 5 æ¬¡å¤šé¡¹å¼ï¼š`6tâµ - 15tâ´ + 10tÂ³`
- ç›®çš„æ˜¯ä½¿æ’å€¼æ›´å¹³æ»‘ï¼Œä¸€é˜¶å’ŒäºŒé˜¶å¯¼æ•°åœ¨ç«¯ç‚¹å¤„ä¸º 0
- äº§ç”Ÿè‡ªç„¶çš„ S å½¢æ›²çº¿

#### 5. æ¢¯åº¦è®¡ç®—ï¼ˆGradientï¼‰

```cpp
double grad(int hash, double x, double y) const {
    int h = hash & 15;
    double u = h < 8 ? x : y;
    double v = h < 4 ? y : (h == 12 || h == 14 ? x : 0);
    return ((h & 1) == 0 ? u : -u) + ((h & 2) == 0 ? v : -v);
}
```

- ä½¿ç”¨ç½®æ¢è¡¨çš„å€¼ï¼ˆhashï¼‰é€‰æ‹© 12 ä¸ªå¯èƒ½çš„æ¢¯åº¦æ–¹å‘ä¹‹ä¸€
- è®¡ç®—ä¼ªéšæœºæ¢¯åº¦å‘é‡ä¸åˆ°è¯¥ç‚¹çš„ç‚¹ç§¯

#### 6. çº¿æ€§æ’å€¼ï¼ˆLerpï¼‰

```cpp
double lerp(double t, double a, double b) {
    return a + t * (b - a);
}
```

- åœ¨ä¸¤ä¸ªå€¼ä¹‹é—´è¿›è¡Œçº¿æ€§æ’å€¼
- ä½¿ç”¨æ·¡å…¥æ·¡å‡ºåçš„ t å€¼

#### 7. åŒçº¿æ€§æ’å€¼

åœ¨ç½‘æ ¼å•å…ƒå››ä¸ªè§’çš„å€¼ä¹‹é—´è¿›è¡ŒåŒçº¿æ€§æ’å€¼ï¼š

```
      (x, y)  â† å·¦ä¸Š      (x + 1, y) â† å³ä¸Š
         â†‘                   â†‘
         |                   |
         â†“                   â†“
      (x, y + 1) â† å·¦ä¸‹  (x + 1, y + 1) â† å³ä¸‹
```

- å…ˆåœ¨ x æ–¹å‘æ’å€¼ä¸¤æ¬¡ï¼ˆå·¦ä¸Š â†” å³ä¸Šï¼Œå·¦ä¸‹ â†” å³ä¸‹ï¼‰
- å†åœ¨ y æ–¹å‘æ’å€¼ä¸€æ¬¡ï¼ˆä¸Šè¾¹ç»“æœ â†” ä¸‹è¾¹ç»“æœï¼‰

### å…«åº¦å™ªå£°ï¼ˆOctave Noiseï¼‰

```cpp
double octaveNoise(double x, double y, int octaves, double persistence) const {
    double total = 0;
    double frequency = 1;
    double amplitude = 1;
    double maxValue = 0;

    for (int i = 0; i < octaves; i++) {
        total += noise(x * frequency, y * frequency) * amplitude;
        maxValue += amplitude;
        amplitude *= persistence;
        frequency *= 2;
    }

    return total / maxValue;
}
```

- å°†å¤šä¸ªä¸åŒé¢‘ç‡å’ŒæŒ¯å¹…çš„ Perlin å™ªå£°å åŠ 
- **é¢‘ç‡ï¼ˆfrequencyï¼‰ï¼šæ¯å¢åŠ ä¸€å€ï¼Œç»†èŠ‚æ›´ç»†å¯†
- **æŒ¯å¹…ï¼ˆamplitudeï¼‰ï¼šæŒ‰ persistence ç³»æ•°è¡°å‡
- **persistenceï¼ˆæŒä¹…åº¦ï¼‰ï¼šæ§åˆ¶ç»†èŠ‚çš„é‡è¦æ€§

**å‚æ•°æ•ˆæœ**ï¼š
- persistence = 0.5 â†’ æ¯ä¸ªå…«åº¦æŒ¯å¹…æ˜¯å‰ä¸€ä¸ªçš„ä¸€åŠï¼Œäº§ç”Ÿè‡ªç„¶åœ°å½¢
- persistence < 0.5 â†’ ä½é¢‘ä¸»å¯¼ï¼Œæ›´å¹³æ»‘
- persistence > 0.5 â†’ é«˜é¢‘ä¸»å¯¼ï¼Œæ›´ç²—ç³™

### åœ°å½¢å½’ä¸€åŒ–

```cpp
void normalizeHeightMap() {
    // æ‰¾åˆ°æœ€å°å’Œæœ€å¤§é«˜åº¦å€¼
    double minVal = 1.0, maxVal = -1.0;
    for (const auto& row : heightMap) {
        for (double val : row) {
            minVal = min(minVal, val);
            maxVal = max(maxVal, val);
        }
    }
    
    // å°†æ‰€æœ‰å€¼æ˜ å°„åˆ° [0, 1] åŒºé—´
    double range = maxVal - minVal;
    for (auto& row : heightMap) {
        for (double& val : row) {
            val = (val - minVal) / range;
        }
    }
}
```

å°†å™ªå£°è¾“å‡ºï¼ˆèŒƒå›´çº¦ä¸º [-1, 1] å½’ä¸€åŒ–åˆ° [0, 1] åŒºé—´ï¼Œä¾¿äºç”Ÿç‰©ç¾¤ç³»åˆ’åˆ†ã€‚

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```cpp
#include "terrain_generator.hpp"
#include <iostream>

int main() {
    std::cout << "=== éšæœºåœ°å½¢ç”Ÿæˆå™¨ ===\n" << std::endl;

    TerrainConfig config(80, 30, 0.03, 5, 0.5);
    TerrainGenerator terrain(config);

    std::cout << "åŸºæœ¬åœ°å½¢ï¼ˆå®å¿ƒæ–¹å—ï¼‰:\n";
    terrain.displayTerrain();
    terrain.displayLegend();
    terrain.printStats();

    return 0;
}
```

### å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|-------|------|
| width | int | 80 | åœ°å½¢å®½åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰ |
| height | int | 40 | åœ°å½¢é«˜åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰ |
| scale | double | 0.02 | ç¼©æ”¾æ¯”ä¾‹ï¼ˆå€¼è¶Šå°è¶Šå¹³æ»‘ï¼‰ |
| octaves | int | 6 | å…«åº¦æ•°é‡ï¼ˆå€¼è¶Šå¤§ç»†èŠ‚è¶Šå¤šï¼‰ |
| persistence | double | 0.6 | æŒä¹…åº¦ï¼ˆå€¼è¶Šå¤§è¶Šç²—ç³™ï¼‰ |

### å‚æ•°è°ƒä¼˜æŠ€å·§

- **ç”Ÿæˆå¹³æ»‘çš„å¹³åŸ**ï¼šä½¿ç”¨ä½å…«åº¦ (3-4) å’Œä½æŒä¹…åº¦ (0.4-0.5)
- **ç”Ÿæˆå´å²–çš„å±±åœ°**ï¼šä½¿ç”¨é«˜å…«åº¦ (6-8) å’Œé«˜æŒä¹…åº¦ (0.7-0.8)
- **ç”Ÿæˆå¤§å‹åœ°å½¢ç‰¹å¾**ï¼šä½¿ç”¨ä½ç¼©æ”¾æ¯”ä¾‹ (0.01-0.02)
- **ç”Ÿæˆå°å‹ç»†èŠ‚**ï¼šä½¿ç”¨é«˜ç¼©æ”¾æ¯”ä¾‹ (0.05-0.10)

## â­ å…³äº

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ çš„å­¦ä¹ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Starï¼

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

è¿™æ˜¯ä¸€ä¸ªä¸ªäººå­¦ä¹ é¡¹ç›®ï¼Œç”¨äºå­¦ä¹ ç¨‹åºåŒ–å†…å®¹ç”ŸæˆæŠ€æœ¯ã€‚
